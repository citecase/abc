<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simple Text Search</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
    input { width: 100%; padding: 0.8rem; font-size: 1.1rem; box-sizing: border-box; }
    #results { margin-top: 1.5rem; }
    .card {
      border: 1px solid #ddd; border-radius: 8px; padding: 1.2rem; margin-bottom: 1rem;
      background: #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .title { font-size: 1.3rem; margin: 0 0 0.6rem; color: #0066cc; }
    .highlight { background: #fff3cd; padding: 1px 3px; border-radius: 3px; }
    .meta { color: #555; font-size: 0.95rem; margin: 0.4rem 0; }
    .no-results { color: #777; font-style: italic; }
  </style>
</head>
<body>

  <h1>Search Items</h1>
  <input type="search" id="search" placeholder="Search titles, features, prices..." autofocus />

  <div id="results"></div>

  <script>
    const DATA_FOLDER = "data/";               // change if your folder is named differently
    const FILE_EXTENSION = ".txt";             // or ".md"
    const searchInput = document.getElementById("search");
    const resultsDiv = document.getElementById("results");

    let items = [];  // will hold {filename, content, lowerContent}

    // 1. List your files here manually (easiest & most reliable for small/medium size)
    const filenames = [
      "item-001.txt",
      "item-002.txt",
      "apple-iphone.txt",
      "samsung-galaxy.txt",
      // add more filenames here as you create files
      // or generate this list once and paste it
    ];

    // 2. Load all files at startup
    async function loadData() {
      resultsDiv.innerHTML = "<p>Loading...</p>";
      items = [];

      for (const name of filenames) {
        try {
          const res = await fetch(DATA_FOLDER + name);
          if (!res.ok) continue;
          const text = await res.text();
          items.push({
            filename: name,
            content: text,
            lower: text.toLowerCase()
          });
        } catch(e) {}
      }

      resultsDiv.innerHTML = `<p>Loaded ${items.length} items. Start typing.</p>`;
    }

    loadData();

    // 3. Live search
    searchInput.addEventListener("input", () => {
      const term = searchInput.value.trim().toLowerCase();
      if (term.length < 1) {
        resultsDiv.innerHTML = "";
        return;
      }

      const matches = items.filter(item => item.lower.includes(term));

      if (matches.length === 0) {
        resultsDiv.innerHTML = '<p class="no-results">No matches found.</p>';
        return;
      }

      resultsDiv.innerHTML = matches.map(item => {
        let display = item.content
          .replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;")  // safe
          .replace(/\n/g, "<br>");  // preserve lines

        // highlight matches (simple)
        if (term) {
          const regex = new RegExp(`(${term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, "gi");
          display = display.replace(regex, '<span class="highlight">$1</span>');
        }

        // optional: try to extract Title if present
        let title = item.filename.replace(FILE_EXTENSION, '');
        const titleMatch = item.content.match(/^Title:\s*(.+)$/im);
        if (titleMatch) title = titleMatch[1];

        return `
          <div class="card">
            <div class="title">${title}</div>
            <div>${display}</div>
          </div>
        `;
      }).join("");
    });
  </script>

</body>
</html>
